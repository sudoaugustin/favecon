!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).favecon=t()}(this,(function(){"use strict";const e=e=>(new DOMParser).parseFromString(e,"text/html"),t=t=>(e=>fetch(e))(t).then((e=>e.text())).then(e).then((e=>e.querySelectorAll("head link"))),n=e=>{const t=["rel","href","sizes"];return[...e].filter((e=>e.getAttribute("href")&&e.getAttribute("rel").includes("icon"))).map((e=>t.reduce(((t,n)=>({...t,[n]:e.getAttribute(n)})),{})))},r=e=>t(e).then(n).then((e=>t=>{const n=e=>new URL(e).origin;return t.map((({sizes:t,href:r,rel:s})=>({size:parseInt(null==t?void 0:t.split("x")[0])||void 0,href:"/"===r[0]?"".concat(n(e)).concat(r):r,rel:s})))})(e)),s=e=>r(e).then((e=>{const t=(e=>e.reduce(((e,t)=>{const n=e.filter((({rel:e})=>t.rel===e))[0];if(n){if(t.size>n.size){const n=e.findIndex((({rel:e})=>t.rel===e));e[n]=t}}else e.push(t);return e}),[]))(e);return t.sort(((e,t)=>t.size-e.size))}));return{getIcons:r,getBestIcons:s,getBestIcon:e=>s(e).then((e=>{const t=e[0];return t&&t.size>50?t:(e=>{const t=e=>e.includes("apple-touch-icon");return e.sort(((e,n)=>t(n.rel)?1:t(e.rel)?-1:0))})(e)}))}}));
